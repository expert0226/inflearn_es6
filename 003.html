<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>3. 컬렉션 중심 프로그래밍</title>
</head>
<body>

</body>
<script src="js/_.js"></script>
<script>
// 컬렉션 중심 프로그래밍의 4가지 유형과 함수

// 1. 수집하기 - map, values, pluck 등
// 2. 거르기 - filter, reject, compact, without 등
// 3. 찾아내기 - find, some, every 등
// 4. 접기 - reduce, min, max, group_by, count_by

const users = [
    { id: 1, name: 'ID', age: 36 },
    { id: 2, name: 'BJ', age: 32 },
    { id: 3, name: 'JM', age: 33 },
    { id: 4, name: 'PJ', age: 27 },
    { id: 5, name: 'HA', age: 25 },
    { id: 6, name: 'JE', age: 26 },
    { id: 7, name: 'JI', age: 31 },
    { id: 8, name: 'MP', age: 23 }
];

// 컬렉션 중심 프로그래밍의 유형별 함수 만들기
// 1. 수집하기 - map
console.log(
    _map(users, user => user.name)
);

// 1.1 values
const a = 10;
//console.log( _identity(a) );
//console.log(users[0]);
//console.log(_keys(users[0]));
//console.log(_values(users[0]));
//console.log(_map(_identity)(users[0]));

// 1.2 pluck
const _pluck = (data, key) => _map(data, _get(key));

console.log( _pluck(users, 'age') );
console.log( _pluck(users, 'name') );
console.log( _pluck(users, 'id') );

// 2. 거르기 - filter
console.log(_filter(users, user => user.age > 30));

// 2.1 reject
console.log(_reject(users, user => user.age > 30));
// 2.2 compact
console.log(_compact([1, 2, 0, false, null, {}]));

// 3. 찾아내기 - find
// 3.1 find 만들기


console.log(_find(users, user => user.age < 30));
console.log(_find(users, user => user.id == 20));

// 3.2 find_index

console.log(_find_index(users, user => user.id == 5))

console.log(_go(users,
    _find(user => user.id == 5))
);

// 3.3 some

console.log(_some([1, 2, 5, 10, 20], val => val > 10));

// 3.4 every
console.log(_every([1, 2, 5, 10, 20], val => val > 10));
console.log(_every([1, 2, 5, 10, 20], val => val > 0));
console.log(_some([1, 2, 0, 10]));
console.log(_every([1, 2, 0, 10]));

console.clear();

// 4. 접기 - reduce
// 4.1 min, max, min_by, max_by

console.log(_min([1, 2, 4, 10, 5, -4]));

console.log(_max([1, 2, 4, 10, 5, -4]));

console.log(_min_by([1, 2, 4, 10, 5, -4], Math.abs));

console.log(_max_by([1, 2, 4, 10, 5, -4], Math.abs));

console.log(_min_by(users, user => user.age));

_go(users,
    _filter(user => user.age >= 30),
    _min_by(_get('age')),
    console.log);

_go(users,
    _reject(user => user.age >= 30),
    _min_by(_get('age')),
    _get('name'),
    console.log);

// 4.2 group_by, push

console.log(_group_by(users, user => parseInt(user.age / 10)));

console.log(_group_by(users, _get('age')));

console.log(_group_by(users, user => user.age - user.age % 10));

console.log(_group_by(users, user => user.name[0]));

console.log(_group_by(users, _pipe(_get('name'), _head)));

_go(users,
    _group_by(user => user.name[0]),
    console.log);

// 4.3 count_by, inc

console.log(_count_by(users, user => user.age));

console.log(_count_by(users, user => user.age - user.age % 10));

console.log(_count_by(users, user => user.name[0]));

_map([1, 2, 3], console.log);

_map(users[0], console.log);

console.log(_map(users[0], (val, key) => [key, val]));

console.log(_pairs(users[0]));

console.clear();

const _document_write = text => document.write(text);

_go(users,
    _filter(user => user.age >= 20),
    _count_by(user => user.age - user.age % 10),
    _map((count, key) => `<li>${key} 대는 ${count} 명 입니다.</li>`),
    list => '<ul>' + list.join('') + '</ul>',
    _document_write);

const f1 = _pipe(
    _filter(user => user.age >= 20),
    _count_by(user => user.age - user.age % 10),
    _map((count, key) => `<li>${key} 대는 ${count} 명 입니다.</li>`),
    list => '<ul>' + list.join('') + '</ul>',
    _document_write);

f1(users);

const f2 = _pipe(_reject(user => user.age < 20), f1);

f2(users);

_go(users, _reject(user => user.age < 20), f1);

</script>
</html>
